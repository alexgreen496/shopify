version: 2

models:
  - name: fct_reviews
    description: Review fact data

    columns:
      - name: app_id
        description: The foreign key to apps.app_id.
        tests:
          - not_null
          - relationships:
              to: ref('dim_apps')
              field: app_id

      - name: author
        description: The author of the review.

      - name: review_rating
        description: The rating given in the review.
        tests:
          - not_null
          - accepted_values:
              values: 
                - 1
                - 2
                - 3
                - 4
                - 5

      - name: posted_at
        description: The date the review was posted.
        tests:
          - not_null

      - name: body
        description: The body of text of the review.

      - name: helpful_count
        description: The count of helpful votes for a review.

      - name: developer_reply
        description: The body of text of the developer reply to the review.

      - name: developer_reply_posted_at
        description: The date that the developer reply was posted.

  - name: dim_apps
    description: App dimension data.

    columns:
      - name: app_id
        description: The primary key for this table.
        tests:
          - not_null

      - name: app_url
        description: The url link to the app's web page.
        tests:
          - not_null

      - name: app_title
        description: The app title.
        tests:
          - not_null

      - name: developer
        description: The name of the developer of the app.
          - not_null

      - name: developer_link
        description: The link to the web page of the developer of the app.
          - not_null
          - unique

      - name: icon
        description: The link to the web page of the icon of the app.
          - not_null
          - unique

      - name: average_rating
        description: The average rating of all reviews of the app.
          - not_null

      - name: reviews_count
        description: A count of the total number of reviews of the app.

      - name: app_description
        description: The description of the app.

      - name: tagline
        description: The tagline of the app.

      - name: pricing_hint
        description: The pricing hint of the app.

      - name: category_id
        description: The primary key to this table.
        tests:
          - not_null

      - name: category_title
        description: Title of the app category.
        tests:
          - not_null
          - accepted_values:
              values: 
                - Inventory management
                - Orders and shipping
                - Marketing
                - Places to sell
                - Finances
                - Productivity
                - Store design
                - Trust and security
                - Reporting
                - Sales and conversion optimization
                - Finding and adding products
                - Customer support

      - name: key_benefit_title
        description: Title of the key benefit of the app.

      - name: key_benefit_description
        description: Description of the key benefit of the app.

      - name: pricing_plan_id
        description: The primary key for pricing_plans used to join on pricing_plan_features.pricing_plan_id.
        tests:
          - unique

      - name: pricing_plan_title
        description: Title of the app's pricing plan.

      - name: price
        description: Price of the pricing plan.

      - name: pricing_plan_feature 
        description: The feature of the pricing plan of the app.

  - name: dim_authors
    description: Authors dimension data.

    columns:
      - name: author_key
        description: The key to fct_reviews.authors.
        tests:
          - not_null

      - name: min_review
        description: The minimum rating the author has given in a review.
        tests:
          - not_null
          - accepted_values:
              values: 
                - 1
                - 2
                - 3
                - 4
                - 5

      - name: max_review
        description: The maximum rating the author has given in a review.
        tests:
          - not_null
          - accepted_values:
              values: 
                - 1
                - 2
                - 3
                - 4
                - 5

      - name: avg_review
        description: The average rating of all the reviews an author has given.
        tests:
          - not_null

      - name: total_apps_reviewed
        description: A count of the total number of apps the author has reviwed.
        tests:
          - not_null

  - name: dim_dates
    description: Dates dimension data.

    columns:
      - name: date_key
        description: The key to date columns in the fct_reviews model.
        tests:
          - not_null
          - unique

      - name: day_of_week
        description: The number of the day of the week associated with the date_key.
        tests:
          - not_null

      - name: day_of_week_name
        description: The name of the day of the week associated with the date_key.
        tests:
          - not_null

      - name: day_of_month
        description: The number of the day of the month associated with the date_key.
        tests:
          - not_null

      - name: month_number
        description: The number of the month of the year associated with the date_key.
        tests:
          - not_null

      - name: month_name
        description: The name of the month of the year associated with the date_key.
        tests:
          - not_null
          
      - name: year_number
        description: The year associated with the date_key.
        tests:
          - not_null
          
      - name: month_year
        description: The month number and year associated with the date_key.
        tests:
          - not_null
      
    